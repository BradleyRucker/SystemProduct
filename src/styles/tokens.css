/* ─────────────────────────────────────────────────────────────────────────────
   Design tokens — single source of truth for the visual language.
   Dark-mode first. Precision Dark direction: Linear/Vercel-inspired.
   ───────────────────────────────────────────────────────────────────────────── */

/* Geist font from Vercel — display headings */
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

:root {
    /* ── Surfaces — cool blue-black, 4 distinct elevation levels ── */
    --surface-base: #080b12; /* app background */
    --surface-raised: #0d1117; /* panels, sidebars */
    --surface-overlay: #141b26; /* cards, dropdowns */
    --surface-float: #1a2235e8; /* floating: modals, context menus (glass-ready) */
    --surface-hover: #1c2438; /* hover state */
    --surface-border: #1e2640; /* dividers */
    --surface-border-subtle: #131928; /* very quiet dividers */
    --surface-border-bright: #2d3a55; /* hover/focus border */

    /* ── Text ── */
    --text-primary: #eaeef5;
    --text-secondary: #7a87a8;
    --text-muted: #404d6a;
    --text-inverse: #080b12;

    /* ── Accent — electric violet-blue ── */
    --accent: #5b6ef5;
    --accent-hover: #7c8cff;
    --accent-dim: #5b6ef514;
    --accent-glow: #5b6ef530;
    --accent-border: #5b6ef550;

    /* ── Node colors — semantic encoding (unchanged) ── */
    --color-requirement: #3b82f6;
    --color-requirement-bg: #3b82f610;
    --color-block: #64748b;
    --color-block-bg: #64748b10;
    --color-interface: #f59e0b;
    --color-interface-bg: #f59e0b10;
    --color-port: #f59e0b;
    --color-port-bg: #f59e0b18;
    --color-test-case: #22c55e;
    --color-test-case-bg: #22c55e10;
    --color-use-case: #a78bfa;
    --color-use-case-bg: #a78bfa10;
    --color-actor: #a78bfa;
    --color-actor-bg: #a78bfa10;
    --color-stakeholder: #94a3b8;
    --color-function: #38bdf8;
    --color-function-bg: #38bdf810;

    /* ── Severity ── */
    --color-error: #ef4444;
    --color-warning: #f59e0b;
    --color-info: #3b82f6;
    --color-success: #22c55e;

    /* ── Severity backgrounds ── */
    --color-error-bg: #ef444414;
    --color-warning-bg: #f59e0b14;
    --color-info-bg: #3b82f614;
    --color-success-bg: #22c55e14;

    /* ── AI suggestion state ── */
    --color-ai-ghost: #7c8cff40;
    --color-ai-ghost-border: #7c8cff;
    --color-ai-ghost-glow: #7c8cff20;

    /* ── Selection ── */
    --color-selected-ring: #5b6ef5;
    --color-selected-glow: #5b6ef530;

    /* ── Canvas ── */
    --canvas-bg: #0d1017;
    --canvas-grid: #161d2a;
    --canvas-grid-major: #1e2a3e;

    /* ── Spacing ── */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-8: 32px;
    --space-10: 40px;
    --space-12: 48px;
    --space-16: 64px;

    /* ── Typography ── */
    --font-sans:
        "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    --font-display:
        "Inter", -apple-system, BlinkMacSystemFont, sans-serif; /* swap to Geist when self-hosted */
    --font-mono: "JetBrains Mono", "Fira Code", "Cascadia Code", monospace;

    --text-xs: 12px;
    --text-sm: 14px;
    --text-base: 16px;
    --text-lg: 18px;
    --text-xl: 24px;
    --text-2xl: 32px;
    --text-3xl: 40px;

    --weight-normal: 400;
    --weight-medium: 500;
    --weight-semibold: 600;
    --weight-bold: 700;

    --leading-tight: 1.18;
    --leading-normal: 1.5;
    --leading-relaxed: 1.65;

    --tracking-tight: -0.02em;
    --tracking-normal: 0em;
    --tracking-wide: 0.06em;
    --tracking-wider: 0.12em;

    /* ── Radius ── */
    --radius-sm: 4px;
    --radius-md: 7px;
    --radius-lg: 11px;
    --radius-xl: 16px;
    --radius-2xl: 22px;
    --radius-full: 9999px;

    /* ── Shadows — cooler tones ── */
    --shadow-sm: 0 1px 3px #00000050, 0 1px 2px #00000030;
    --shadow-md: 0 4px 16px #00000070;
    --shadow-lg: 0 8px 32px #000000a0, 0 2px 8px #00000060;
    --shadow-xl: 0 20px 60px #000000c0, 0 4px 16px #00000080;

    /* Glass shadow + ring (for floating panels) */
    --shadow-float:
        0 8px 32px #000000a0, 0 0 0 1px #ffffff08, inset 0 1px 0 #ffffff0a;

    /* ── Transitions ── */
    --transition-fast: 120ms ease;
    --transition-normal: 220ms ease;
    --transition-slow: 360ms ease;
    --transition-spring: 200ms cubic-bezier(0.34, 1.56, 0.64, 1);

    /* ── Z-index layers ── */
    --z-canvas: 0;
    --z-edges: 10;
    --z-nodes: 20;
    --z-ghosts: 30;
    --z-ui: 100;
    --z-panel: 200;
    --z-dropdown: 300;
    --z-tooltip: 400;
    --z-modal: 500;
}

/* ── Base reset ── */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html,
body {
    height: 100%;
    background: var(--surface-base);
    color: var(--text-primary);
    font-family: var(--font-sans);
    font-size: var(--text-base);
    line-height: var(--leading-normal);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    user-select: none;
    /* Smooth theme transitions — covers color, border, background switches */
    transition:
        background-color var(--transition-slow) ease,
        color var(--transition-slow) ease;
}

/* Allow text selection in input-like elements */
input,
textarea,
[contenteditable] {
    user-select: text;
}

/* ── Scrollbar ── */
::-webkit-scrollbar {
    width: 5px;
    height: 5px;
}
::-webkit-scrollbar-track {
    background: transparent;
}
::-webkit-scrollbar-thumb {
    background: var(--surface-border);
    border-radius: var(--radius-full);
}
::-webkit-scrollbar-thumb:hover {
    background: var(--text-muted);
}

/* ── Header gradients ── */
:root {
    --header-grad-a: #0e1525;
    --header-grad-b: #080b12;
}

/* ─────────────────────────────────────────────────────────────────────────────
   Global component upgrades — applied app-wide via tokens
   ───────────────────────────────────────────────────────────────────────────── */

/* Primary button — gradient + inner highlight */
.btn-primary,
button.btn-primary {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    background: linear-gradient(135deg, #6b7fff 0%, #5b6ef5 100%);
    color: #fff;
    border: none;
    border-radius: var(--radius-md);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    cursor: pointer;
    transition: all var(--transition-fast);
    box-shadow:
        0 1px 4px #5b6ef550,
        inset 0 1px 0 #ffffff20;
    white-space: nowrap;
    text-decoration: none;
}
.btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, #7c8cff 0%, #6b7fff 100%);
    box-shadow:
        0 2px 8px #5b6ef570,
        inset 0 1px 0 #ffffff25;
    transform: translateY(-1px);
}
.btn-primary:active:not(:disabled) {
    transform: translateY(0) scale(0.98);
    box-shadow: 0 1px 2px #5b6ef540;
}
.btn-primary:disabled {
    opacity: 0.35;
    cursor: not-allowed;
}

/* Ghost button */
.btn-ghost,
button.btn-ghost {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    background: none;
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-md);
    color: var(--text-secondary);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    cursor: pointer;
    transition: all var(--transition-fast);
    white-space: nowrap;
    text-decoration: none;
}
.btn-ghost:hover:not(:disabled) {
    background: var(--surface-hover);
    border-color: var(--surface-border-bright);
    color: var(--text-primary);
}
.btn-ghost:active:not(:disabled) {
    transform: scale(0.98);
    background: var(--surface-border);
}
.btn-ghost:disabled {
    opacity: 0.35;
    cursor: not-allowed;
}

/* Danger button */
.btn-danger,
button.btn-danger {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    background: var(--color-error-bg);
    border: 1px solid #ef444440;
    border-radius: var(--radius-md);
    color: var(--color-error);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    cursor: pointer;
    transition: all var(--transition-fast);
}
.btn-danger:hover:not(:disabled) {
    background: #ef444425;
    border-color: var(--color-error);
}
.btn-danger:active:not(:disabled) {
    transform: scale(0.98);
    background: #ef444435;
}
.btn-danger:disabled {
    opacity: 0.35;
    cursor: not-allowed;
}

/* Small variants */
.btn-primary-sm {
    composes: btn-primary;
    padding: 3px var(--space-3);
    font-size: var(--text-xs);
}
.btn-ghost-sm {
    composes: btn-ghost;
    padding: 3px var(--space-3);
    font-size: var(--text-xs);
}

/* ── Form fields ── */
.field,
input.field,
textarea.field,
select.field {
    width: 100%;
    background: var(--surface-raised);
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-md);
    color: var(--text-primary);
    font-family: var(--font-sans);
    font-size: var(--text-sm);
    font-weight: var(--weight-medium);
    padding: 9px var(--space-3);
    transition:
        border-color var(--transition-fast),
        box-shadow var(--transition-fast);
    outline: none;
}
.field:focus {
    border-color: var(--accent-border);
    box-shadow: 0 0 0 3px var(--accent-glow);
}
.field::placeholder {
    color: var(--text-muted);
}

/* ── Modal ── */
.modal-backdrop {
    position: fixed;
    inset: 0;
    background: #00000070;
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: var(--z-modal);
    animation: fadeIn var(--transition-normal) ease;
}

.modal {
    background: var(--surface-float);
    backdrop-filter: blur(20px);
    border: 1px solid #ffffff0e;
    border-radius: var(--radius-xl);
    padding: var(--space-6);
    width: 380px;
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    box-shadow: var(--shadow-float);
    animation: slideUp var(--transition-normal) var(--transition-spring);
}
.modal h2 {
    font-size: var(--text-lg);
    font-weight: var(--weight-semibold);
    letter-spacing: var(--tracking-tight);
}
.modal-actions {
    display: flex;
    gap: var(--space-2);
    justify-content: flex-end;
    padding-top: var(--space-2);
}
.modal-error {
    font-size: var(--text-sm);
    color: var(--color-error);
    background: var(--color-error-bg);
    border: 1px solid #ef444430;
    border-radius: var(--radius-md);
    padding: var(--space-2) var(--space-3);
}
.field-label {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    font-size: var(--text-sm);
    color: var(--text-secondary);
    font-weight: var(--weight-medium);
}

/* ── Page header ── */
.page-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    padding: var(--space-4) var(--space-6) var(--space-3);
    border-bottom: 1px solid var(--surface-border-subtle);
    background: linear-gradient(
        160deg,
        var(--header-grad-a) 0%,
        var(--header-grad-b) 75%
    );
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
}
.page-header::after {
    content: "";
    position: absolute;
    right: -70px;
    top: -70px;
    width: 170px;
    height: 170px;
    border-radius: 50%;
    pointer-events: none;
    background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
}
.page-header > * {
    position: relative;
    z-index: 1;
}
.page-header .header-left,
.page-header .page-header-copy {
    max-width: 620px;
}
.page-eyebrow {
    font-size: var(--text-xs);
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--accent-hover);
    margin-bottom: 2px;
}
.page-title {
    font-size: clamp(24px, 1.8vw, 30px);
    font-weight: var(--weight-bold);
    letter-spacing: var(--tracking-tight);
    color: var(--text-primary);
    line-height: var(--leading-tight);
}
.page-subtitle {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    margin-top: 4px;
    line-height: var(--leading-relaxed);
    max-width: 58ch;
}

@media (max-width: 1100px) {
    .page-header {
        flex-wrap: wrap;
        align-items: flex-start;
        padding: var(--space-3) var(--space-4);
    }
    .page-title {
        font-size: clamp(22px, 4.6vw, 28px);
    }
}

/* ── Cards ── */
.card {
    background: var(--surface-overlay);
    border: 1px solid var(--surface-border);
    border-radius: var(--radius-lg);
    transition:
        border-color var(--transition-fast),
        box-shadow var(--transition-fast),
        transform var(--transition-fast);
}
.card:hover {
    border-color: var(--surface-border-bright);
    box-shadow: var(--shadow-md);
}
.card-interactive:hover {
    border-color: var(--accent-border);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
}

/* ── Empty state ── */
.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-4);
    padding: var(--space-16) var(--space-8);
    text-align: center;
    color: var(--text-muted);
    background: linear-gradient(
        180deg,
        var(--surface-overlay) 0%,
        transparent 80%
    );
    border: 1px dashed var(--surface-border);
    border-radius: var(--radius-xl);
}
.empty-state-icon {
    width: 62px;
    height: 62px;
    color: var(--accent-hover);
    opacity: 0.8;
    padding: 14px;
    border-radius: 50%;
    background:
        radial-gradient(circle at 30% 30%, var(--accent-glow), transparent 65%),
        var(--surface-overlay);
    border: 1px solid var(--accent-border);
}
.empty-state-title {
    font-size: var(--text-lg);
    font-weight: var(--weight-semibold);
    color: var(--text-secondary);
    letter-spacing: var(--tracking-tight);
}
.empty-state-body {
    font-size: var(--text-base);
    color: var(--text-muted);
    max-width: 320px;
    line-height: var(--leading-relaxed);
}

/* ── Badge / chip ── */
.badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 2px var(--space-2);
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: var(--weight-medium);
    border: 1px solid;
    white-space: nowrap;
}
.badge-success {
    color: var(--color-success);
    border-color: #22c55e30;
    background: var(--color-success-bg);
    box-shadow: 0 0 0 2px #22c55e08;
}
.badge-warning {
    color: var(--color-warning);
    border-color: #f59e0b30;
    background: var(--color-warning-bg);
    box-shadow: 0 0 0 2px #f59e0b08;
}
.badge-error {
    color: var(--color-error);
    border-color: #ef444430;
    background: var(--color-error-bg);
    box-shadow: 0 0 0 2px #ef444408;
}
.badge-info {
    color: var(--color-info);
    border-color: #3b82f630;
    background: var(--color-info-bg);
    box-shadow: 0 0 0 2px #3b82f608;
}
.badge-accent {
    color: var(--accent-hover);
    border-color: var(--accent-border);
    background: var(--accent-dim);
    box-shadow: 0 0 0 2px var(--accent-glow);
}
.badge-neutral {
    color: var(--text-secondary);
    border-color: var(--surface-border);
    background: var(--surface-overlay);
}

/* ── Animations ── */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}
@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-6px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
@keyframes scaleIn {
    from {
        opacity: 0;
        transform: scale(0.96);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}
@keyframes pulse {
    0%,
    100% {
        opacity: 1;
    }
    50% {
        opacity: 0.4;
    }
}
.animate-spin {
    animation: spin 0.75s linear infinite;
}
.animate-fadein {
    animation: fadeIn var(--transition-normal) ease;
}
.animate-pulse {
    animation: pulse 1.4s ease-in-out infinite;
}

/* ── Spinner component ── */
.spinner {
    width: 16px;
    height: 16px;
    border: 2px solid var(--surface-border);
    border-top-color: var(--accent);
    border-radius: var(--radius-full);
    animation: spin 0.75s linear infinite;
    flex-shrink: 0;
}
.spinner-sm {
    width: 12px;
    height: 12px;
    border-width: 1.5px;
}
.spinner-lg {
    width: 24px;
    height: 24px;
    border-width: 2.5px;
}
/* Centered loading overlay */
.loading-center {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    height: 100%;
    width: 100%;
    color: var(--text-muted);
    font-size: var(--text-sm);
}

/* ─────────────────────────────────────────────────────────────────────────────
   Light theme overrides
   ───────────────────────────────────────────────────────────────────────────── */
:root[data-theme="light"] {
    --surface-base: #f4f6fb;
    --surface-raised: #ffffff;
    --surface-overlay: #eef1f8;
    --surface-float: #ffffffee;
    --surface-hover: #e8ecf5;
    --surface-border: #d0d6e8;
    --surface-border-subtle: #e4e8f2;
    --surface-border-bright: #b0bada;

    --text-primary: #111420;
    --text-secondary: #4a5270;
    --text-muted: #7a86a8;
    --text-inverse: #ffffff;

    --accent: #2563eb;
    --accent-hover: #1d4ed8;
    --accent-dim: #2563eb18;
    --accent-glow: #2563eb28;
    --accent-border: #2563eb50;

    --color-requirement: #2563eb;
    --color-requirement-bg: #2563eb10;
    --color-block: #64748b;
    --color-block-bg: #64748b10;
    --color-interface: #d97706;
    --color-interface-bg: #d9770610;
    --color-port: #d97706;
    --color-port-bg: #d9770618;
    --color-test-case: #16a34a;
    --color-test-case-bg: #16a34a10;
    --color-use-case: #7c3aed;
    --color-use-case-bg: #7c3aed10;
    --color-actor: #7c3aed;
    --color-actor-bg: #7c3aed10;
    --color-stakeholder: #64748b;
    --color-function: #0284c7;
    --color-function-bg: #0284c710;

    --color-error: #dc2626;
    --color-warning: #d97706;
    --color-info: #2563eb;
    --color-success: #16a34a;

    --color-error-bg: #dc262610;
    --color-warning-bg: #d9770610;
    --color-info-bg: #2563eb10;
    --color-success-bg: #16a34a10;

    --canvas-bg: #f4f6fb;
    --canvas-grid: #dde2ef;
    --canvas-grid-major: #c8d0e5;

    --shadow-sm: 0 1px 3px #0f172a14, 0 1px 2px #0f172a0a;
    --shadow-md: 0 4px 16px #0f172a20;
    --shadow-lg: 0 8px 32px #0f172a28, 0 2px 8px #0f172a14;
    --shadow-xl: 0 20px 60px #0f172a30, 0 4px 16px #0f172a18;
    --shadow-float:
        0 8px 32px #0f172a28, 0 0 0 1px #0000000a, inset 0 1px 0 #ffffff80;

    --header-grad-a: #eaeff8;
    --header-grad-b: #f4f6fb;
}
